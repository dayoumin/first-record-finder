# 프로젝트 논의 요약

## 1. 프로젝트 목표

한국 수산생물의 최초기록 문헌을 체계적으로 검색하고 검증하는 시스템 구축

### 핵심 요구사항
1. WoRMS에서 학명의 모든 이명(synonyms) 추출
2. 각 이명으로 한국 문헌 검색
3. **단순 언급이 아닌 실제 서식 근거** 확인
4. 근거의 정확한 위치(페이지, 내용) 추출
5. 엑셀 + 웹 뷰어로 결과 출력

---

## 2. 전체 워크플로우 (100개 학명 처리 예시)

```
┌─────────────────────────────────────────────────────────────────────┐
│  Phase 1: 학명 입력                                                  │
│  ──────────────────                                                 │
│  - 개별 입력: 학명 1개씩                                             │
│  - 엑셀 업로드: 100개 학명 일괄 입력                                  │
│                                                                     │
│  입력 형식: 속명 + 종명 (예: Sebastes schlegelii)                    │
│  ※ 저자명, 대소문자, 이명 입력 모두 허용 (WoRMS가 자동 처리)          │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  Phase 2: WoRMS 이명 추출 (자동)                                     │
│  ────────────────────────────                                       │
│  각 학명마다:                                                        │
│  1. WoRMS API 호출                                                  │
│  2. 유효명 + 모든 이명 추출                                          │
│  3. 검색용 URL 생성 (Google Scholar, KCI)                           │
│  4. 결과 저장                                                       │
│                                                                     │
│  결과: 100개 학명 → 약 500~1000개 이명 목록                          │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  Phase 3: 문헌 검색 (수동/반자동)                                    │
│  ──────────────────────────────                                     │
│  각 이명으로:                                                        │
│  1. Google Scholar / KCI 검색                                       │
│  2. 한국 관련 문헌 필터링                                            │
│  3. 연도순 정렬 (오래된 것 먼저)                                     │
│  4. 후보 문헌 목록 작성                                              │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  Phase 4: 문헌 확보 및 검토 (수동)                                   │
│  ──────────────────────────────                                     │
│  각 후보 문헌마다:                                                   │
│  1. PDF/원문 확보                                                   │
│  2. 학명이 언급된 페이지 찾기                                        │
│  3. 서식 근거 확인 (채집지, 날짜, 표본 등)                           │
│  4. 인용문 추출                                                     │
│  5. 신뢰도 레벨 판정                                                │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  Phase 5: 결과 저장 및 분석                                          │
│  ────────────────────────                                           │
│  1. 검토 결과 입력 (UI에서)                                          │
│  2. 최초 기록 판정                                                  │
│  3. 엑셀 내보내기                                                   │
│  4. 추가 검토 필요 항목 표시                                         │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 중요 결정사항 (⚠️ 잊지 말 것!)

### 3.1 학명 입력 형식 - 제한 없음

**WoRMS API가 알아서 처리해주는 것들** (테스트 완료 2024-12):

| 입력 형식 | 예시 | 결과 |
|-----------|------|------|
| 기본 형식 | Sebastes schlegelii | ✅ 정상 인식 |
| 저자 포함 | Sebastes schlegelii Hilgendorf, 1880 | ✅ 정상 인식 |
| 철자 변이 | Sebastes schlegeli (i 하나) | ✅ 자동 보정 |
| 과거 속명 | Sebastichthys schlegelii | ✅ 유효명으로 매핑 |
| 아속명 포함 | Sebastes (Sebastocles) schlegelii | ✅ 정상 인식 |
| 소문자 | sebastes schlegelii | ✅ 정상 인식 |
| 대문자 | SEBASTES SCHLEGELII | ✅ 정상 인식 |

**결론: 사용자가 어떤 형식으로 입력해도 WoRMS가 올바른 유효명으로 매핑해준다.**

### 3.2 이명 연도 - 검색 제한에 사용하지 않음

**잘못된 접근:**
```
❌ "이명이 1880년에 발표되었으니 1880년 이후만 검색"
```

**올바른 접근:**
```
✅ "모든 이명으로 전체 기간 검색"

이유:
1. 학명 변경 후에도 구 명칭 계속 사용하는 경우 많음
2. 저자가 분류학적 변경을 모르고 구 명칭 사용
3. 구 문헌 인용 시 원래 명칭 그대로 사용
4. 습관적으로 익숙한 명칭 사용

예시: Fugu rubripes → Takifugu rubripes (1990년대 변경)
      → 2000년대 이후에도 "Fugu rubripes" 사용 문헌 존재
```

**이명 연도의 올바른 활용:**
- ✅ 참고용: "이 이명은 1880년에 처음 발표됨"
- ✅ 원기재 확인: 어느 문헌에서 처음 기재되었는지
- ❌ 검색 제한: 연도 이후만 검색 → 잘못됨

---

## 4. 확정 레벨 분류 (중요!)

최초 기록 확정이 애매한 경우가 많으므로 4단계로 분류:

### Level 1: 확정 (Confirmed)
- 한국 해역 채집지 명시
- 채집 일자/표본 정보 있음
- 형태 기재 또는 사진 있음
- **→ 검색 중단 가능**

### Level 2: 유력 (Probable)
- "한국", "조선" 언급 있음
- 채집 정보 일부 누락
- 예: "한국 남해안에 서식" (구체적 채집 기록 없음)
- **→ 일단 기록, 더 오래된 문헌 계속 탐색**

### Level 3: 검토 필요 (Needs Review)
- 학명은 있으나 지역 불명확
- 분포 목록에만 "Korea" 표기
- 인용인지 직접 기록인지 불분명
- **→ 기록 + 수동 검토 대기열에 추가**

### Level 4: 제외 (Excluded)
- 명백한 타 문헌 인용
- 한국 언급 없음
- 오동정 가능성
- **→ 참고용으로만 기록**

---

## 5. 애매한 기록의 원인

| 원인 | 설명 | 예시 |
|------|------|------|
| no_locality | 채집지 정보 없음 | "한국에 분포" |
| no_specimen | 표본 정보 없음 | 채집지는 있으나 표본번호 없음 |
| unclear_if_citation | 인용인지 불명확 | "Kim (1990)에 의하면..." |
| distribution_list_only | 분포 목록만 | "분포: 일본, 한국, 중국" |
| korea_unspecified | 한국 내 위치 불명 | "Korea" (동해? 서해? 남해?) |
| date_missing | 채집 날짜 없음 | 장소는 있으나 언제인지 불명 |

---

## 6. 출력 형식

### 엑셀 (3개 시트)

**Sheet 1: 검색 결과 요약**
| 학명 | 최초기록 문헌 | 연도 | 신뢰도 | 상태 | 비고 |
|------|--------------|------|--------|------|------|
| Sebastes schlegelii | 정문기 (1977) | 1977 | high | 확정 | |

**Sheet 2: 상세 기록**
| 학명 | 문헌 | 페이지 | 검색명 | 원문 인용 |
|------|------|--------|--------|----------|
| ... | ... | p.234 | S. schlegelii | "부산 기장에서..." |

**Sheet 3: 이명 목록**
| 현재 유효명 | 이명 | 상태 | 원기재 |
|------------|------|------|--------|
| ... | ... | synonym | ... |

### 웹 뷰어
- 학명 검색 → 최초기록 + 이명 + 후보 문헌 표시
- 엑셀 다운로드 버튼
- 수동 검토 기능 (향후)

---

## 7. 검색 데이터소스

### 학술 데이터베이스
- Google Scholar
- KCI (한국학술지인용색인)
- CrossRef (DOI 기반)
- RISS, DBpia

### 기관 자료
- 국립수산과학원 보고서
- 국립해양생물자원관
- 한국해양생물다양성 (KORIB)

### 역사적 문헌
- 일제강점기 조선 해양조사 보고서
- 초기 한국 어류학 논문 (정문기, 최기철 등)
- 조선총독부 수산시험장 보고

---

## 8. 기술 스택

| 용도 | 도구 |
|------|------|
| 이명 추출 | WoRMS REST API |
| 문헌 검색 | Google Scholar (puppeteer/serpapi), KCI API |
| PDF 분석 | pdf-parse |
| 엑셀 출력 | xlsx (SheetJS) |
| 웹 뷰어 | Next.js |
| 데이터 저장 | JSON / SQLite |

---

## 9. 개발 현황

### 완료된 기능 (2024-12)
- [x] WoRMS 이명 추출 (API 호출, 이명/연도 추출)
- [x] 검색 URL 생성 (Google Scholar, KCI)
- [x] 엑셀 출력 (3개 시트)
- [x] 웹 뷰어 기본 (검색 + 결과 표시)
- [x] CLI 스크립트

### 다음 단계
1. [ ] 문헌 기록 입력 UI (검색 후 결과 기록 폼)
2. [ ] 학명 일괄 입력 (엑셀 업로드)
3. [ ] 검색 결과 저장/관리
4. [ ] PDF 분석 (선택적)

---

## 10. 향후 고려사항

1. **PDF 자동 분석**: 업로드된 PDF에서 학명 검색 → 페이지/문맥 자동 추출
2. **수동 검토 워크플로우**: 애매한 기록을 전문가가 검토하는 UI
3. **기존 데이터 연동**: 한국해양생물목록, KORIB 등 기존 최초기록 정보 활용
4. **일본어/한자 문헌**: 일제강점기 문헌 해독 지원

---

*문서 작성일: 2024-12*
*마지막 업데이트: 2024-12*
